
Всем нам рано или поздно приходится тестировать UI — и это, возможно, не так просто, как могло бы показаться.

На прошлой работе у нас был свой небольшой внутренний проект — библиотека индикаторов. В один прекрасный момент встал вопрос о тестировании. Недостаточно было просто протестировать преобразования данных — это, конечно, важно, но это еще не все. Хотелось протестировать отрисовку индикаторов — как минимум, сколько их должно быть на странице, отображаются ли они. Отображаются ли в них числа, нужное количество столбцов и т.п.

![](https://cdn-images-1.medium.com/max/800/1*y3bHQAfTgAOKXls1WHQvDQ.png)

За пару месяцев до этого мне на глаза попался Puppeteer и я решила использовать его для тестирования.

О чем я в итоге хочу рассказать:

- Что это такое
- Как это работает
- Как помогает в тестировании веб приложений
- Что в нем есть для тестирования производительности и метрик

Итак, что же такое Puppeteer?

Это Node.js библиотека для автоматизации тестирования в браузере (chromium), которую продвигает Google. Все взаимодействия между браузером и нодой идут через DevTools Protocol, и они асинхронны.

![](https://cdn-images-1.medium.com/max/800/1*pukBDwaZFMLV5wZ3AD4S3w.png)

Устанавливается она просто: 

**_npm i puppeteer_** или **_npm i puppeteer-core_**.

Разница в том, что в первом случае при установке так же подтягивается хромиум (~200mb), но если вы решите использовать второй вариант, будьте уверены, что используете нужную версию браузера.

Как вы могли заметить — это не кросбраузерная библиотека, но на случай firefox есть вариант **_npm i puppeteer-firefox_**_._ Он экспериментальный и поддерживает ~90% API puppeteer, но стоит заметить, что за те пол года, пока эта статья валялась у меня в черновиках, каких-то подвижек в нем не произошло. Проверить, чего в нем не хватает, можно [здесь](https://aslushnikov.github.io/ispuppeteerfirefoxready/).

Для работы вам не нужны никакие доп настройки или конфиги, просто создаете node.js скрипт и пишете в нем:

![](https://cdn-images-1.medium.com/max/800/1*8pOJbsQcFJ-GCyFqVv2jjA.png)